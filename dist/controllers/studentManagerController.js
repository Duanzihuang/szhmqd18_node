"use strict";var xtpl=require("xtpl"),path=require("path"),databasetool=require(path.join(__dirname,"../tools/databasetool.js"));exports.getStudentListPage=function(n,d){var s=n.query.keyword||"";databasetool.findList("studentInfo",{name:{$regex:s}},function(t,e){xtpl.renderFile(path.join(__dirname,"../views/list.html"),{studentList:e,keyword:s,loginedName:n.session.loginedName},function(t,e){d.send(e)})})},exports.getAddStudentPage=function(t,n){xtpl.renderFile(path.join(__dirname,"../views/add.html"),{loginedName:t.session.loginedName},function(t,e){n.send(e)})},exports.addStudent=function(t,n){databasetool.insertOne("studentInfo",t.body,function(t,e){null==e?n.send('<script>alert("插入失败")<\/script>'):n.send('<script>location.href = "/studentmanager/list"<\/script>')})},exports.getEditStudentPage=function(n,d){var t=databasetool.ObjectId(n.params.studentId);databasetool.findOne("studentInfo",{_id:t},function(t,e){xtpl.renderFile(path.join(__dirname,"../views/edit.html"),{studentInfo:e,loginedName:n.session.loginedName},function(t,e){d.send(e)})})},exports.editStudent=function(t,n){var e=databasetool.ObjectId(t.params.studentId);databasetool.updateOne("studentInfo",{_id:e},t.body,function(t,e){null==e?n.send('<script>alert("修改失败")<\/script>'):n.send('<script>location.href = "/studentmanager/list"<\/script>')})},exports.deleteStudent=function(t,n){var e=databasetool.ObjectId(t.params.studentId);databasetool.deleteOne("studentInfo",{_id:e},function(t,e){null==e?n.send('<script>alert("删除失败")<\/script>'):n.send('<script>location.href = "/studentmanager/list"<\/script>')})};